
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3. Security Aspects and Technical Fundamentals of Blockchain Technology &#8212; Blockchain Security</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'book/0_3_concepts_of_security';</script>
    <link rel="canonical" href="https://phelstab.github.io/blocksec/book/0_3_concepts_of_security.html" />
    <link rel="icon" href="../_static/fav.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4. Attack Vectors on Blockchains" href="0_4_attack_vectors.html" />
    <link rel="prev" title="2. Fundamentals and Principles of Blockchains" href="0_2_concepts.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Blockchain Security - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Blockchain Security - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="0_1_introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="0_2_concepts.html">2. Fundamentals and Principles of Blockchains</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">3. Security Aspects and Technical Fundamentals of Blockchain Technology <!-- (*20 Minuten*) --></a></li>
<li class="toctree-l1"><a class="reference internal" href="0_4_attack_vectors.html">4. Attack Vectors on Blockchains</a></li>
<li class="toctree-l1"><a class="reference internal" href="1_exercise.html">Exercise 1: Simulating Blockchain Attacks Using the Proof-of-Work Network Simulator</a></li>

<li class="toctree-l1"><a class="reference internal" href="1_exercise_cheatsheet.html">Cheat Sheet Exercise 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_exercise.html">Exercise 2: CTF</a></li>
<li class="toctree-l1"><a class="reference internal" href="9_bibliography.html">Bibliography</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/phelstab/blocksec/master?urlpath=tree/book/0_3_concepts_of_security.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/phelstab/blocksec/blob/master/book/0_3_concepts_of_security.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/phelstab/blocksec" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/phelstab/blocksec/edit/main/book/0_3_concepts_of_security.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/phelstab/blocksec/issues/new?title=Issue%20on%20page%20%2Fbook/0_3_concepts_of_security.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/book/0_3_concepts_of_security.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>3. Security Aspects and Technical Fundamentals of Blockchain Technology <!-- (*20 Minuten*) --></h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cryptographic-hash-functions">3.1.1 Cryptographic Hash Functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computation">Computation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cryptography">Cryptography</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hash-pointers">3.1.2 Hash Pointers</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#merkle-trees">3.1.3 Merkle Trees</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transaction-validation">Transaction Validation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-does-a-merkle-tree-form-to-blocks-in-a-blockchain">How does a Merkle Tree form to blocks in a blockchain?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#why-do-we-need-this-in-blockchains">Why do we need this in blockchains?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#proof-of-membership-and-nonmembership">Proof of Membership and Nonmembership</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#utxo">3.1.5 UTXO</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#digital-signatures">3.1.5 Digital Signatures</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#elliptic-curve-digital-signature-algorithm-ecdsa">Elliptic Curve Digital Signature Algorithm (ECDSA)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#secp256k1">Secp256k1</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#identities">3.1.6 Identities</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#consensus-algorithm">3.1.7 Consensus Algorithm</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#which-transactions-are-the-valid-ones-mining">Which transactions are the valid ones? (Mining)</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="security-aspects-and-technical-fundamentals-of-blockchain-technology">
<h1>3. Security Aspects and Technical Fundamentals of Blockchain Technology <!-- (*20 Minuten*) --><a class="headerlink" href="#security-aspects-and-technical-fundamentals-of-blockchain-technology" title="Link to this heading">#</a></h1>
<p><strong>Core idea of blockchain technology:</strong></p>
<ul class="simple">
<li><p>Create a decentralized system</p></li>
<li><p>Enable transactions between parties (agents)</p></li>
<li><p>Eliminate the need for intermediaries</p></li>
<li><p>Remove reliance on trusted third parties</p></li>
</ul>
<p><strong>How to achieve blockchain technology:</strong></p>
<ul class="simple">
<li><p>Mathematical models take over all the functional foundations of blockchain technology.</p></li>
<li><p>Mathematical models that enable cryptographic encryption based on computability and complexity take on the tasks of an intermediary.</p></li>
<li><p>The system itself distributes these tasks to all agents in the system, even if they receive a task that is not related to their own transactions.</p></li>
</ul>
<p>It is replaced as follows:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>The Object</p></th>
<th class="head"><p>Centralized FIAT Object</p></th>
<th class="head"><p>Blockchain</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>The Storage of Value</p></td>
<td><p>Bank Account / Physical Wallet</p></td>
<td><p>Public + Private Key linked to realized and unspent transactions held by all participants in the system</p></td>
</tr>
<tr class="row-odd"><td><p>Transaction</p></td>
<td><p>(Digital) Transaction through trustee (middleman) or physical handover between parties</p></td>
<td><p>Publishing that an object has a new owner by its current owner to the whole system through a cryptographic signature</p></td>
</tr>
<tr class="row-even"><td><p>Identity Verification</p></td>
<td><p>Governmental ID cards, passwords, various authentication methods</p></td>
<td><p>Decentralized identifiers (DIDs), cryptographic proofs, and blockchain-based identity verification</p></td>
</tr>
</tbody>
</table>
</div>
<!-- Die Kernidee hinter der Blockchain liegt darin ein System zu schaffen das es ermöglicht komplett Dezentral und somit ohne jegliche Intermediäre und damit auch ohne Treuhänder, Transaktionen zwischen Agenten zu ermöglichen.  -->
<!-- Dabei übernehmen Mathematische Modelle die auf der Berechenbarkeit und Komplexität Kryptographische verschlüsselungen ermgöglichen, die Aufgaben eines Intermediärs und verteilen diese Aufgaben auf alle Agenten die Teil des Systems sind auch wenn diese eine Aufgabe erhalten die nicht ihrer eigenen Transaktion dient. -->
<section id="cryptographic-hash-functions">
<h2>3.1.1 Cryptographic Hash Functions<a class="headerlink" href="#cryptographic-hash-functions" title="Link to this heading">#</a></h2>
<p>Because the concept of blockchains is built on different aspects of computation theory, cryptography, and distributed computing, we will start with the core aspects that form a blockchain and begin with the <em>cryptographic hash functions</em>.</p>
<p>This is a more uncommon approach in science, but we want to first define what properties our hash functions must hold so they can be used in common blockchains, and we will understand the “Why?” later when everything comes together.</p>
<section id="computation">
<h3>Computation<a class="headerlink" href="#computation" title="Link to this heading">#</a></h3>
<p><strong>Computational Property 1: <em>Input Flexibility</em></strong></p>
<ul class="simple">
<li><p>The input can be any string of any size.</p></li>
</ul>
<p><strong>Computational Property 2: <em>Fixed-Sized Output</em></strong></p>
<ul class="simple">
<li><p>The function produces a fixed-sized output.</p></li>
<li><p>For this discussion, a 256-bit output size is assumed, but the property holds for any sufficiently large output size.</p></li>
</ul>
<p><strong>Computational Property 3: <em>Efficient Computability</em></strong></p>
<ul class="simple">
<li><p>The hash function is efficiently computable, meaning that for a given input string, the output can be determined in a reasonable amount of time.</p></li>
<li><p>Technically, computing the hash of an n-bit string should have a running time of O(n).</p></li>
</ul>
</section>
<section id="cryptography">
<h3>Cryptography<a class="headerlink" href="#cryptography" title="Link to this heading">#</a></h3>
<p><strong>Cryptographic Property 1: <em>Collision Resistance</em></strong></p>
<p><strong>Definition:</strong> A hash function ( H ) is said to be collision resistant if it is infeasible to find two values, ( x ) and ( y ), such that ( x \neq y ), yet ( H(x) = H(y) ).</p>
<p><em>Why we need this?</em></p>
<ul class="simple">
<li><p>We need collision resistance to ensure that it is infeasible to find two different inputs that produce the same hash output.</p></li>
<li><p>This is crucial for maintaining data integrity and preventing forgery.</p></li>
</ul>
<p><em>Example:</em></p>
<ul class="simple">
<li><p>When a transaction is created, it is hashed to produce a transaction ID.</p></li>
<li><p>If an attacker could find two different transactions that produce the same hash (collision), they could potentially replace a legitimate transaction with a fraudulent one without being detected.</p></li>
<li><p>This would undermine the integrity of the blockchain.</p></li>
</ul>
<p><strong>Cryptographic Property 2: <em>Hiding</em></strong></p>
<p><strong>Definition:</strong> A hash function ( H ) is said to be hiding if, when a secret value ( r ) is chosen from a probability distribution that has high min-entropy, then, given ( H(r \parallel x) ), it is infeasible to find ( x ).</p>
<p><em>Why we need this?</em></p>
<ul class="simple">
<li><p>We need the hiding property to ensure that given a hash output, it is infeasible to determine the original input.</p></li>
<li><p>This is essential for preserving the confidentiality of the input data.</p></li>
</ul>
<p><em>Example:</em></p>
<ul class="simple">
<li><p>The hiding property ensures that the nonce and other block header data cannot be easily deduced from the hash output.</p></li>
<li><p>Maintains the difficulty and security of the mining process.</p></li>
</ul>
<p><strong>Cryptographic Property 3: <em>Puzzle Friendliness</em></strong></p>
<p><strong>Definition:</strong> A hash function ( H ) is said to be puzzle friendly if for every possible ( n )-bit output value ( y ), if ( k ) is chosen from a distribution with high min-entropy, then it is infeasible to find ( x ) such that ( H(k | x) = y ) in time significantly less than ( 2^n ).</p>
<p><em>Why we need this?</em></p>
<ul class="simple">
<li><p>Puzzle friendliness ensures that solving the hash function requires a brute-force search.</p></li>
<li><p>Prevents shortcuts and maintains the security of cryptographic protocols.</p></li>
</ul>
<p><em>Example:</em></p>
<ul class="simple">
<li><p>In Bitcoin mining:</p>
<ul>
<li><p>Miners must find a nonce such that the hash of the block header concatenated with the nonce produces a hash with a certain number of leading zeros.</p></li>
<li><p>Puzzle friendliness ensures there are no shortcuts to finding this nonce.</p></li>
<li><p>Maintains the difficulty and security of the mining process.</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="hash-pointers">
<h2>3.1.2 Hash Pointers<a class="headerlink" href="#hash-pointers" title="Link to this heading">#</a></h2>
<p>The next thing we need are so called Hash Pointers. Imagine a Linked List</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">linked_list</span> <span class="kn">import</span> <span class="n">LinkedList</span>

<span class="n">ll</span> <span class="o">=</span> <span class="n">LinkedList</span><span class="p">()</span>
<span class="n">ll</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Beta&quot;</span><span class="p">)</span>
<span class="n">ll</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Alpha&quot;</span><span class="p">)</span>
<span class="n">ll</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Delta&quot;</span><span class="p">)</span>
<span class="n">ll</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Gamma&quot;</span><span class="p">)</span>

<span class="n">ll</span><span class="o">.</span><span class="n">print_list</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Beta -&gt; Alpha -&gt; Delta -&gt; Gamma -&gt; None
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><strong>Problem: Ensuring Static Linkage of Values</strong></p>
<ul>
<li><p>We need to ensure that values are statically linked together.</p></li>
<li><p>We want to make sure that we cannot change any value in the middle of the linked list without changing every value before the changed one.</p></li>
</ul>
</li>
<li><p><strong>Solution: Hash Pointers</strong></p>
<ul>
<li><p>Hash Pointers connect a hash of the previous node’s data to the current node.</p></li>
<li><p>Any change in the data of a node will affect the hash, and thus the hash pointer in the next node.</p></li>
<li><p>This creates a chain reaction, ensuring data integrity.</p></li>
</ul>
</li>
<li><p><strong>Visualization:</strong></p>
<ul>
<li><p>Imagine a linked list where each node contains:</p>
<ul>
<li><p>Data</p></li>
<li><p>Hash Pointer to the previous node’s data</p></li>
</ul>
</li>
<li><p>Changing the data in any node will:</p>
<ul>
<li><p>Change the hash of that node</p></li>
<li><p>Change the hash pointer in the next node</p></li>
<li><p>Continue affecting all subsequent nodes</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">linked_list</span> <span class="kn">import</span> <span class="n">HashLinkedList</span>

<span class="n">hll</span> <span class="o">=</span> <span class="n">HashLinkedList</span><span class="p">()</span>
<span class="n">hll</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Beta&quot;</span><span class="p">)</span>
<span class="n">hll</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Alpha&quot;</span><span class="p">)</span>
<span class="n">hll</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Delta&quot;</span><span class="p">)</span>
<span class="n">hll</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Gamma&quot;</span><span class="p">)</span>
<span class="n">hll</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Zeta&quot;</span><span class="p">)</span>
<span class="n">hll</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Omega&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original List:&quot;</span><span class="p">)</span>
<span class="n">hll</span><span class="o">.</span><span class="n">print_list</span><span class="p">()</span>
<span class="n">hll</span><span class="o">.</span><span class="n">visualize</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Original List:
Data: Beta, Hash: 703390318bd55aef50b7823d2b90a846debff99e6e3d401a24a921b733912a6d, Prev Hash: 
Data: Alpha, Hash: 9517f7b5d2664f38da15735d8f2a44407c8de29d1e1d488d10b9275d0fd3604b, Prev Hash: 703390318bd55aef50b7823d2b90a846debff99e6e3d401a24a921b733912a6d
Data: Delta, Hash: b09121c00f7dacaf6e4e234fe340f71fa28d894393f4e5f78fab5a585ea5147f, Prev Hash: 9517f7b5d2664f38da15735d8f2a44407c8de29d1e1d488d10b9275d0fd3604b
Data: Gamma, Hash: d6e8a5f5e135051299749acc19d6ef182fe246f6440e6f7daad29e0ee8a3ce73, Prev Hash: b09121c00f7dacaf6e4e234fe340f71fa28d894393f4e5f78fab5a585ea5147f
Data: Zeta, Hash: 009b9901cdc0dd709c4e345fc750cb31b95c9e4fb79d12d89a58fb1de3926ffd, Prev Hash: d6e8a5f5e135051299749acc19d6ef182fe246f6440e6f7daad29e0ee8a3ce73
Data: Omega, Hash: 51ee1c31e1301e451649b629c4cc06f4f29fe48909c73bf009d412a873ccfbcc, Prev Hash: 009b9901cdc0dd709c4e345fc750cb31b95c9e4fb79d12d89a58fb1de3926ffd
</pre></div>
</div>
<div class="output text_html"><div style="font-family: monospace;"><div style="display: inline-block; border: 1px solid black; padding: 10px; margin: 5px;"><p>Data: Beta</p><p>Hash: 70339031...</p><p>Prev Hash: ...</p></div><div style="display: inline-block; vertical-align: top; padding: 10px;">&#8594;</div><div style="display: inline-block; border: 1px solid black; padding: 10px; margin: 5px;"><p>Data: Alpha</p><p>Hash: 9517f7b5...</p><p>Prev Hash: 70339031...</p></div><div style="display: inline-block; vertical-align: top; padding: 10px;">&#8594;</div><div style="display: inline-block; border: 1px solid black; padding: 10px; margin: 5px;"><p>Data: Delta</p><p>Hash: b09121c0...</p><p>Prev Hash: 9517f7b5...</p></div><div style="display: inline-block; vertical-align: top; padding: 10px;">&#8594;</div><div style="display: inline-block; border: 1px solid black; padding: 10px; margin: 5px;"><p>Data: Gamma</p><p>Hash: d6e8a5f5...</p><p>Prev Hash: b09121c0...</p></div><div style="display: inline-block; vertical-align: top; padding: 10px;">&#8594;</div><div style="display: inline-block; border: 1px solid black; padding: 10px; margin: 5px;"><p>Data: Zeta</p><p>Hash: 009b9901...</p><p>Prev Hash: d6e8a5f5...</p></div><div style="display: inline-block; vertical-align: top; padding: 10px;">&#8594;</div><div style="display: inline-block; border: 1px solid black; padding: 10px; margin: 5px;"><p>Data: Omega</p><p>Hash: 51ee1c31...</p><p>Prev Hash: 009b9901...</p></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hll</span><span class="o">.</span><span class="n">manipulate_data</span><span class="p">(</span><span class="s2">&quot;Delta&quot;</span><span class="p">,</span> <span class="s2">&quot;DeltaModified&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">List after manipulating &#39;Delta&#39;:&quot;</span><span class="p">)</span>
<span class="n">hll</span><span class="o">.</span><span class="n">print_list</span><span class="p">()</span>
<span class="n">hll</span><span class="o">.</span><span class="n">visualize</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>List after manipulating &#39;Delta&#39;:
Data: Beta, Hash: 703390318bd55aef50b7823d2b90a846debff99e6e3d401a24a921b733912a6d, Prev Hash: 
Data: Alpha, Hash: 9517f7b5d2664f38da15735d8f2a44407c8de29d1e1d488d10b9275d0fd3604b, Prev Hash: 703390318bd55aef50b7823d2b90a846debff99e6e3d401a24a921b733912a6d
Data: DeltaModified, Hash: 21185a34b6ad429fbc23a71cdf7cecf19b81dc3938159b759b01d9a5dcff6b64, Prev Hash: 9517f7b5d2664f38da15735d8f2a44407c8de29d1e1d488d10b9275d0fd3604b
Data: Gamma, Hash: d6e8a5f5e135051299749acc19d6ef182fe246f6440e6f7daad29e0ee8a3ce73, Prev Hash: b09121c00f7dacaf6e4e234fe340f71fa28d894393f4e5f78fab5a585ea5147f
Data: Zeta, Hash: 009b9901cdc0dd709c4e345fc750cb31b95c9e4fb79d12d89a58fb1de3926ffd, Prev Hash: d6e8a5f5e135051299749acc19d6ef182fe246f6440e6f7daad29e0ee8a3ce73
Data: Omega, Hash: 51ee1c31e1301e451649b629c4cc06f4f29fe48909c73bf009d412a873ccfbcc, Prev Hash: 009b9901cdc0dd709c4e345fc750cb31b95c9e4fb79d12d89a58fb1de3926ffd
</pre></div>
</div>
<div class="output text_html"><div style="font-family: monospace;"><div style="display: inline-block; border: 1px solid black; padding: 10px; margin: 5px;"><p>Data: Beta</p><p>Hash: 70339031...</p><p>Prev Hash: ...</p></div><div style="display: inline-block; vertical-align: top; padding: 10px;">&#8594;</div><div style="display: inline-block; border: 1px solid black; padding: 10px; margin: 5px;"><p>Data: Alpha</p><p>Hash: 9517f7b5...</p><p>Prev Hash: 70339031...</p></div><div style="display: inline-block; vertical-align: top; padding: 10px;">&#8594;</div><div style="display: inline-block; border: 1px solid black; padding: 10px; margin: 5px;"><p>Data: DeltaModified</p><p>Hash: 21185a34...</p><p>Prev Hash: 9517f7b5...</p></div><div style="display: inline-block; vertical-align: top; padding: 10px;">&#8594;</div><div style="display: inline-block; border: 1px solid black; padding: 10px; margin: 5px;"><p>Data: Gamma</p><p>Hash: d6e8a5f5...</p><p>Prev Hash: b09121c0...</p></div><div style="display: inline-block; vertical-align: top; padding: 10px;">&#8594;</div><div style="display: inline-block; border: 1px solid black; padding: 10px; margin: 5px;"><p>Data: Zeta</p><p>Hash: 009b9901...</p><p>Prev Hash: d6e8a5f5...</p></div><div style="display: inline-block; vertical-align: top; padding: 10px;">&#8594;</div><div style="display: inline-block; border: 1px solid black; padding: 10px; margin: 5px;"><p>Data: Omega</p><p>Hash: 51ee1c31...</p><p>Prev Hash: 009b9901...</p></div></div></div></div>
</div>
<p>This structure called <em>tamper-evident log</em> is secure against manipulation and hold the following properties:</p>
<ul class="simple">
<li><p>Tamper Evidence: Any change in the data can be detected.
*Integrity: The integrity of the data is maintained as long as the hash pointers are intact.</p></li>
</ul>
<p>However, this structure alone is not sufficient for a full-fledged blockchain with transactions due to the following reasons:</p>
<ul class="simple">
<li><p>Efficiency in Verification: Verifying the integrity of a single block requires traversing the entire chain from the head to the block in question. This can be inefficient for large blockchains.</p></li>
<li><p>Proof of Membership: Proving that a particular transaction exists in the blockchain is not straightforward and requires traversing the entire chain.</p></li>
<li><p>Proof of Nonmembership: Proving that a particular transaction does not exist is even more complex and inefficient.</p></li>
</ul>
<p>Merkle trees address these inefficiencies by providing a more structured and efficient way to verify data integrity and membership.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># https://en.wikipedia.org/wiki/Merkle%E2%80%93Damg%C3%A5rd_construction</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="merkle-trees">
<h2>3.1.3 Merkle Trees<a class="headerlink" href="#merkle-trees" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Efficient Verification: In a Merkle tree, each leaf node represents a data block (e.g., a transaction), and each non-leaf node represents the hash of its child nodes. The root of the tree is a hash that represents the entire dataset. Verifying the integrity of a single block only requires a logarithmic number of hash computations (log(n)), making it much more efficient than traversing the entire chain.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">merkle_tree</span> <span class="kn">import</span> <span class="n">merkleTree</span><span class="p">,</span> <span class="n">visualizeTree</span>

<span class="n">transactions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;transaction1&#39;</span><span class="p">,</span> <span class="s1">&#39;transaction2&#39;</span><span class="p">,</span> <span class="s1">&#39;transaction3&#39;</span><span class="p">,</span> <span class="s1">&#39;transaction4&#39;</span><span class="p">]</span>
<span class="n">tree</span> <span class="o">=</span> <span class="n">merkleTree</span><span class="p">()</span>
<span class="n">tree</span><span class="o">.</span><span class="n">makeTreeFromArray</span><span class="p">(</span><span class="n">transactions</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">calculateMerkleRoot</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Merkle Root:&quot;</span><span class="p">,</span> <span class="n">tree</span><span class="o">.</span><span class="n">getMerkleRoot</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Tree Structure:&quot;</span><span class="p">)</span>
<span class="n">visualizeTree</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Merkle Root: 0cf77e26eb4a27047852cf39e3868c7a69ff1109acb9e799ba422d3ac350fb97

Tree Structure:
.: 0cf77e26eb4a27047852cf39e3868c7a69ff1109acb9e799ba422d3ac350fb97
    L: 830b7f324af3ff2b2a47cf7cf5ac825fe8d8034294ea8e8f853a4d3fada893fc
        L: bde4693e55a336ff81ab238ce20cae1dd9c8ba03b9b8f43963f5569bf3cf5229
        R: 4beace8bdcf9b5b74630eaee2e7f501180e46025ca89b05e7e041fbe953d817a
    R: 882ed7f97314e753d0084ea24c386afd3cbd0fb34b3744bfb81d9d3a925cc6e6
        L: 293755ab6384e02d9202d483f2f0250100d786e75fdab1b6f3925b2800ece3cb
        R: 2435dc0372e12b3f7684fb7093fbe6f6dee79dbff96cc28b1687839ef526e02f
</pre></div>
</div>
</div>
</div>
</section>
<section id="transaction-validation">
<h2>Transaction Validation<a class="headerlink" href="#transaction-validation" title="Link to this heading">#</a></h2>
<p><strong>L:</strong> <code class="docutils literal notranslate"><span class="pre">830b7f324af3ff2b2a47cf7cf5ac825fe8d8034294ea8e8f853a4d3fada893fc</span></code></p>
<p><strong>Should be:</strong></p>
<ul class="simple">
<li><p><strong>Transaction 1:</strong> <code class="docutils literal notranslate"><span class="pre">bde4693e55a336ff81ab238ce20cae1dd9c8ba03b9b8f43963f5569bf3cf5229</span></code></p></li>
<li><p><strong>+</strong></p></li>
<li><p><strong>Transaction 2:</strong> <code class="docutils literal notranslate"><span class="pre">4beace8bdcf9b5b74630eaee2e7f501180e46025ca89b05e7e041fbe953d817a</span></code></p></li>
</ul>
<p><strong>Result:</strong></p>
<ul class="simple">
<li><p><strong>Expected:</strong> <code class="docutils literal notranslate"><span class="pre">830b7f324af3ff2b2a47cf7cf5ac825fe8d8034294ea8e8f853a4d3fada893fc</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hash_functions</span> <span class="kn">import</span> <span class="n">sha256_hash</span>

<span class="k">def</span> <span class="nf">verify_merkle_tree</span><span class="p">():</span>
        <span class="n">txn1_hash</span> <span class="o">=</span> <span class="s1">&#39;bde4693e55a336ff81ab238ce20cae1dd9c8ba03b9b8f43963f5569bf3cf5229&#39;</span>
        <span class="n">txn2_hash</span> <span class="o">=</span> <span class="s1">&#39;4beace8bdcf9b5b74630eaee2e7f501180e46025ca89b05e7e041fbe953d817a&#39;</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="s1">&#39;830b7f324af3ff2b2a47cf7cf5ac825fe8d8034294ea8e8f853a4d3fada893fc&#39;</span>
        
        <span class="n">combined_hash</span> <span class="o">=</span> <span class="n">sha256_hash</span><span class="p">(</span><span class="n">txn1_hash</span> <span class="o">+</span> <span class="n">txn2_hash</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Combined hash: </span><span class="si">{</span><span class="n">combined_hash</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected: </span><span class="si">{</span><span class="n">expected</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">combined_hash</span> <span class="o">==</span> <span class="n">expected</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Hash mismatch: </span><span class="si">{</span><span class="n">combined_hash</span><span class="si">}</span><span class="s2"> != </span><span class="si">{</span><span class="n">expected</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="n">verify_merkle_tree</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Combined hash: 830b7f324af3ff2b2a47cf7cf5ac825fe8d8034294ea8e8f853a4d3fada893fc
Expected: 830b7f324af3ff2b2a47cf7cf5ac825fe8d8034294ea8e8f853a4d3fada893fc
</pre></div>
</div>
</div>
</div>
<p>We can also prove that the negation is valid.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">verify_merkle_tree</span><span class="p">():</span>
        <span class="n">txn1_hash</span> <span class="o">=</span> <span class="s1">&#39;bde4693e55a336ff81ab238ce20cae1dd9c8ba03b9b8f43963f5569bf3cf5228&#39;</span>
        <span class="n">txn2_hash</span> <span class="o">=</span> <span class="s1">&#39;4beace8bdcf9b5b74630eaee2e7f501180e46025ca89b05e7e041fbe953d817a&#39;</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="s1">&#39;830b7f324af3ff2b2a47cf7cf5ac825fe8d8034294ea8e8f853a4d3fada893fc&#39;</span>
        
        <span class="n">combined_hash</span> <span class="o">=</span> <span class="n">sha256_hash</span><span class="p">(</span><span class="n">txn1_hash</span> <span class="o">+</span> <span class="n">txn2_hash</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Combined hash: </span><span class="si">{</span><span class="n">combined_hash</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected: </span><span class="si">{</span><span class="n">expected</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">combined_hash</span> <span class="o">==</span> <span class="n">expected</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Hash mismatch: </span><span class="si">{</span><span class="n">combined_hash</span><span class="si">}</span><span class="s2"> != </span><span class="si">{</span><span class="n">expected</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="n">verify_merkle_tree</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Combined hash: ed16d3014e104c1dea31d8cf9d137daf0231f620b7c39bc291957f15e3ebda4d
Expected: 830b7f324af3ff2b2a47cf7cf5ac825fe8d8034294ea8e8f853a4d3fada893fc
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">AssertionError</span><span class="g g-Whitespace">                            </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="n">line</span> <span class="mi">12</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span>         <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected: </span><span class="si">{</span><span class="n">expected</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span>         <span class="k">assert</span> <span class="n">combined_hash</span> <span class="o">==</span> <span class="n">expected</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Hash mismatch: </span><span class="si">{</span><span class="n">combined_hash</span><span class="si">}</span><span class="s2"> != </span><span class="si">{</span><span class="n">expected</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="ne">---&gt; </span><span class="mi">12</span> <span class="n">verify_merkle_tree</span><span class="p">()</span>

<span class="nn">Cell In[7], line 10,</span> in <span class="ni">verify_merkle_tree</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Combined hash: </span><span class="si">{</span><span class="n">combined_hash</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected: </span><span class="si">{</span><span class="n">expected</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">10</span> <span class="k">assert</span> <span class="n">combined_hash</span> <span class="o">==</span> <span class="n">expected</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Hash mismatch: </span><span class="si">{</span><span class="n">combined_hash</span><span class="si">}</span><span class="s2"> != </span><span class="si">{</span><span class="n">expected</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="ne">AssertionError</span>: Hash mismatch: ed16d3014e104c1dea31d8cf9d137daf0231f620b7c39bc291957f15e3ebda4d != 830b7f324af3ff2b2a47cf7cf5ac825fe8d8034294ea8e8f853a4d3fada893fc
</pre></div>
</div>
</div>
</div>
<!-- Erweiterungs-Angriff (Extension-Attack) -->
<section id="how-does-a-merkle-tree-form-to-blocks-in-a-blockchain">
<h3>How does a Merkle Tree form to blocks in a blockchain?<a class="headerlink" href="#how-does-a-merkle-tree-form-to-blocks-in-a-blockchain" title="Link to this heading">#</a></h3>
<img src="../_static/images/merkle_tree.png">
<p>Important Practical properties Merkle Tree vs. Hashed linked lists:</p>
<ul class="simple">
<li><p>Scalability: Merkle trees scale well with the size of the dataset. As the number of transactions grows, the depth of the tree increases logarithmically, maintaining efficient verification times.</p></li>
<li><p>Concise Proofs: Both membership and nonmembership proofs are concise and efficient, making them suitable for large datasets.</p></li>
<li><p>Parallelism: Merkle trees allow for parallel computation of hashes, which can speed up the process of building and verifying the tree.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="k">def</span> <span class="nf">fetch_latest_block</span><span class="p">():</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;https://blockchain.info/q/latesthash?cors=true&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">fetch_merkle_root_and_transactions</span><span class="p">(</span><span class="n">block</span><span class="p">):</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;https://blockchain.info/rawblock/</span><span class="si">{</span><span class="n">block</span><span class="si">}</span><span class="s1">?cors=true&#39;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;mrkl_root&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">tx</span><span class="p">[</span><span class="s1">&#39;hash&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">tx</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;tx&#39;</span><span class="p">]]</span>

<span class="k">def</span> <span class="nf">to_bytes</span><span class="p">(</span><span class="n">hex_str</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">hex_str</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">to_hex</span><span class="p">(</span><span class="n">byte_arr</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">byte_arr</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">to_pairs</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="mi">2</span><span class="p">)]</span>

<span class="k">def</span> <span class="nf">hash_pair</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">b</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">a</span>
    <span class="n">bytes_combined</span> <span class="o">=</span> <span class="n">to_bytes</span><span class="p">(</span><span class="n">b</span> <span class="o">+</span> <span class="n">a</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">hashed</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">bytes_combined</span><span class="p">)</span><span class="o">.</span><span class="n">digest</span><span class="p">())</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">to_hex</span><span class="p">(</span><span class="n">hashed</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">merkle_proof</span><span class="p">(</span><span class="n">txs</span><span class="p">,</span> <span class="n">tx</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">proof</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">proof</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">txs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">proof</span><span class="p">,</span> <span class="n">steps</span>

    <span class="n">tree</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">to_pairs</span><span class="p">(</span><span class="n">txs</span><span class="p">):</span>
        <span class="n">hash_val</span> <span class="o">=</span> <span class="n">hash_pair</span><span class="p">(</span><span class="o">*</span><span class="n">pair</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tx</span> <span class="ow">in</span> <span class="n">pair</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">pair</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">tx</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
            <span class="n">proof</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">idx</span><span class="p">,</span> <span class="n">pair</span><span class="p">[</span><span class="n">idx</span><span class="p">]))</span>
            <span class="n">tx</span> <span class="o">=</span> <span class="n">hash_val</span>
        <span class="n">tree</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hash_val</span><span class="p">)</span>
        <span class="n">steps</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">merkle_proof</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">tx</span><span class="p">,</span> <span class="n">proof</span><span class="p">,</span> <span class="n">steps</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">merkle_proof_root</span><span class="p">(</span><span class="n">proof</span><span class="p">,</span> <span class="n">tx</span><span class="p">):</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">tx</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">tx</span> <span class="ow">in</span> <span class="n">proof</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">idx</span><span class="p">:</span>
            <span class="n">root</span> <span class="o">=</span> <span class="n">hash_pair</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">tx</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">root</span> <span class="o">=</span> <span class="n">hash_pair</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span> <span class="n">root</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">root</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">latest_block</span> <span class="o">=</span> <span class="n">fetch_latest_block</span><span class="p">()</span>
    <span class="n">root</span><span class="p">,</span> <span class="n">txs</span> <span class="o">=</span> <span class="n">fetch_merkle_root_and_transactions</span><span class="p">(</span><span class="n">latest_block</span><span class="p">)</span>
    <span class="n">tx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">txs</span><span class="p">)</span>
    <span class="c1"># manipulate the transaction</span>
    <span class="c1"># tx = tx.replace(&#39;0&#39;, &#39;1&#39;)</span>
    <span class="n">proof</span><span class="p">,</span> <span class="n">steps</span> <span class="o">=</span> <span class="n">merkle_proof</span><span class="p">(</span><span class="n">txs</span><span class="p">,</span> <span class="n">tx</span><span class="p">)</span>
    <span class="n">block_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">txs</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Block size: </span><span class="si">{</span><span class="n">block_size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Steps taken: </span><span class="si">{</span><span class="n">steps</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">merkle_proof_root</span><span class="p">(</span><span class="n">proof</span><span class="p">,</span> <span class="n">tx</span><span class="p">)</span> <span class="o">==</span> <span class="n">root</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="why-do-we-need-this-in-blockchains">
<h3>Why do we need this in blockchains?<a class="headerlink" href="#why-do-we-need-this-in-blockchains" title="Link to this heading">#</a></h3>
<p>To cheaply (cheaply in the sense of computation) verify if a transaction existed in a block, which we can find out by checking if the merkle root is correct.</p>
<p>To check we only need:</p>
<ol class="arabic simple">
<li><p>The merkle root</p></li>
<li><p>The hash of the transaction that I want to check.</p></li>
<li></li>
</ol>
</section>
<section id="proof-of-membership-and-nonmembership">
<h3>Proof of Membership and Nonmembership<a class="headerlink" href="#proof-of-membership-and-nonmembership" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Proof of Membership:</strong> To prove that a particular transaction is part of the blockchain, you only need to provide the transaction, its hash, and the hashes of its sibling nodes up to the root. This proof is concise and can be verified in logarithmic time.</p></li>
<li><p><strong>Proof of Nonmembership:</strong> In a sorted Merkle tree, proving nonmembership involves showing the path to the items just before and after the position where the transaction would be. This proof is also efficient and can be verified in logarithmic time.</p></li>
</ul>
</section>
</section>
<section id="utxo">
<h2>3.1.5 UTXO<a class="headerlink" href="#utxo" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Bitcoin Script</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="digital-signatures">
<h2>3.1.5 Digital Signatures<a class="headerlink" href="#digital-signatures" title="Link to this heading">#</a></h2>
<section id="elliptic-curve-digital-signature-algorithm-ecdsa">
<h3>Elliptic Curve Digital Signature Algorithm (ECDSA)<a class="headerlink" href="#elliptic-curve-digital-signature-algorithm-ecdsa" title="Link to this heading">#</a></h3>
</section>
<section id="secp256k1">
<h3>Secp256k1<a class="headerlink" href="#secp256k1" title="Link to this heading">#</a></h3>
</section>
</section>
<section id="identities">
<h2>3.1.6 Identities<a class="headerlink" href="#identities" title="Link to this heading">#</a></h2>
</section>
<section id="consensus-algorithm">
<h2>3.1.7 Consensus Algorithm<a class="headerlink" href="#consensus-algorithm" title="Link to this heading">#</a></h2>
<section id="which-transactions-are-the-valid-ones-mining">
<h3>Which transactions are the valid ones? (Mining)<a class="headerlink" href="#which-transactions-are-the-valid-ones-mining" title="Link to this heading">#</a></h3>
<!-- ## Security Problems -->
<!-- (Überleitung) -->
<!-- Sehr sehr wichtig: -->
<!-- https://bitcoin.org/en/bitcoin-core/features/validation --></section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./book"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="0_2_concepts.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">2. Fundamentals and Principles of Blockchains</p>
      </div>
    </a>
    <a class="right-next"
       href="0_4_attack_vectors.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">4. Attack Vectors on Blockchains</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cryptographic-hash-functions">3.1.1 Cryptographic Hash Functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computation">Computation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cryptography">Cryptography</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hash-pointers">3.1.2 Hash Pointers</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#merkle-trees">3.1.3 Merkle Trees</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transaction-validation">Transaction Validation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-does-a-merkle-tree-form-to-blocks-in-a-blockchain">How does a Merkle Tree form to blocks in a blockchain?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#why-do-we-need-this-in-blockchains">Why do we need this in blockchains?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#proof-of-membership-and-nonmembership">Proof of Membership and Nonmembership</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#utxo">3.1.5 UTXO</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#digital-signatures">3.1.5 Digital Signatures</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#elliptic-curve-digital-signature-algorithm-ecdsa">Elliptic Curve Digital Signature Algorithm (ECDSA)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#secp256k1">Secp256k1</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#identities">3.1.6 Identities</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#consensus-algorithm">3.1.7 Consensus Algorithm</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#which-transactions-are-the-valid-ones-mining">Which transactions are the valid ones? (Mining)</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By phelstab & dstucke
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>